#!/bin/sh
# Backs up to local machine from my phone running sshd in termux

cache="${XDG_CACHE_HOME:-"$HOME/.cache"}/backup_source"

mkdir -p "$(dirname "$cache")"
touch "$cache"

read -erp "Backup from: " -i "$(head -n1 "$cache")"
echo "$REPLY" > "$cache"
read -eri "rsync -vhrte 'ssh -p 8022' --progress --chmod=F-w --del --backup-dir=.trash --exclude='.*' $REPLY:storage/shared/backup/ ~/backup"
eval "$REPLY"
